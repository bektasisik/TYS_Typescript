(()=>{"use strict";var t={300:(t,e)=>{var n=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==n)return n;throw new Error("unable to locate global object")}();t.exports=e=n.fetch,n.fetch&&(e.default=n.fetch.bind(n)),e.Headers=n.Headers,e.Request=n.Request,e.Response=n.Response},674:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Attendance=void 0,e.Attendance=class{constructor(t,e){this.date=new Date,this.today=this.date.getDate()+"/"+(this.date.getMonth()+1)+"/"+this.date.getFullYear()+" "+this.date.getHours()+":"+this.date.getMinutes()+":"+this.date.getSeconds(),this.id=t,this.prayerTime=e}showInfoAttendance(){console.log(this.id+" "+this.prayerTime+" "+this.today)}}},406:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Student=void 0,e.Student=class{constructor(t,e,n){this.id=t,this.name=e,this.surname=n,this.absent=0}increaseAbsent(){this.absent=this.absent+1}setName(t){this.name=t}setSurname(t){this.surname=t}showInfoStudent(){console.log(this.name+" "+this.surname+" "+this.absent)}}},669:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.StudentAttendance=void 0,e.StudentAttendance=class{constructor(t,e,n){this.student=t,this.attendance=e,this.isAbsence=n}getAttendance(){return this.attendance}getStudent(){return this.student}getIsAbsenceToString(t){return t?"Var":"Yok"}showInfoStudentAttendance(){console.log(this.student+" "+this.attendance+" "+this.getIsAbsenceToString)}}},607:function(t,e,n){var d=this&&this.__awaiter||function(t,e,n,d){return new(n||(n=Promise))((function(s,i){function o(t){try{c(d.next(t))}catch(t){i(t)}}function a(t){try{c(d.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?s(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}c((d=d.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0});const s=n(287),i=n(711),o=new s.StudentService,a=new i.AttendanceService,c=document.getElementById("addStudentButton"),r=document.getElementById("updateStudentButton"),u=document.getElementById("takeAttendanceButton"),l=document.getElementById("nameInput"),h=document.getElementById("surnameInput"),m=document.getElementById("selectPrayerTime"),p=document.getElementsByName("selectAbsence"),f=(document.getElementById("selectListWithAttendanceId"),document.getElementById("mySelectStudentId"),document.getElementById("studentListBody")),v=document.getElementById("takeAttendanceBody");let y;function g(){!function(){d(this,void 0,void 0,(function*(){f.innerHTML="",(yield o.getStudents()).forEach((t=>{const e=document.createElement("tr"),n=document.createElement("td"),d=document.createElement("td"),s=document.createElement("td"),i=document.createElement("td"),a=document.createElement("td"),u=document.createElement("td"),m=document.createElement("td"),p=document.createElement("button"),v=document.createElement("button");n.innerHTML=t.id.toString(),d.innerText=t.name,s.innerText=t.surname,i.innerText=t.absent.toString(),p.setAttribute("class","btn btn-danger"),p.setAttribute("id","deleteButton"),p.setAttribute("data-id",t.id.toString()),p.innerHTML='<i class="fas fa-trash-alt"></i>',v.setAttribute("class","btn btn-primary"),v.setAttribute("id","updateButton"),v.setAttribute("data-id",t.id.toString()),v.innerHTML='<i class="fa-solid fa-edit"></i>',a.appendChild(p),u.appendChild(v),e.appendChild(n),e.appendChild(d),e.appendChild(s),e.appendChild(i),m.appendChild(a),m.appendChild(u),m.setAttribute("class","d-flex justify-content-around"),e.appendChild(m),f.appendChild(e),p.addEventListener("click",(()=>{console.log("Silme"),o.deleteStudent(Number(p.dataset.id)),g()})),v.addEventListener("click",(()=>{y=t,l.value=y.name,h.value=y.surname,c.style.display="none",r.style.display="block",r.setAttribute("data-id",y.id.toString())}))}))}))}(),function(){d(this,void 0,void 0,(function*(){v.innerHTML="",(yield o.getStudents()).forEach((t=>{const e=document.createElement("tr"),n=document.createElement("td"),d=document.createElement("td"),s=document.createElement("td"),i=document.createElement("td"),o=document.createElement("select"),a=document.createElement("option"),c=document.createElement("option");n.innerHTML=t.id.toString(),d.innerText=t.name,s.innerText=t.surname,o.setAttribute("class","form-select"),o.setAttribute("name","selectAbsence"),o.setAttribute("aria-label","select example"),a.setAttribute("value","+"),c.setAttribute("value","-"),a.innerText="+",c.innerText="-",o.appendChild(a),o.appendChild(c),i.appendChild(o),e.appendChild(n),e.appendChild(d),e.appendChild(s),e.appendChild(i),v.appendChild(e)}))}))}()}document.getElementById("tbodyListForAttendance"),g(),c.addEventListener("click",(t=>d(void 0,void 0,void 0,(function*(){t.preventDefault(),console.log("Ekleme"),yield o.addStudent(l.value,h.value),l.value="",h.value="",g()})))),r.addEventListener("click",(t=>d(void 0,void 0,void 0,(function*(){console.log("Güncelleme"),yield o.updateStudent(y.id,l.value,h.value),l.value="",h.value="",g(),c.style.display="block",r.style.display="none",t.preventDefault()})))),u.addEventListener("click",(t=>d(void 0,void 0,void 0,(function*(){console.log("Yoklama alma");const e=new Map;(yield o.getStudents()).forEach(((t,n)=>{e.set(t,"+"===p[n].value)})),a.takeAttendance(m.value,e),console.log(a.getAttendanceList()),g(),function(){const t=a.getAttendanceList(),e=document.getElementById("selectListWithAttendanceId");e.innerHTML="";const n=document.createElement("option");n.setAttribute("disabled","disabled"),n.innerText="Lütfen Listelemek İstedğiniz Vakti Seçiniz...",e.appendChild(n),t.forEach((t=>{const n=document.createElement("option");n.setAttribute("value",t.id.toString()),n.innerText=t.today+" "+t.prayerTime,e.appendChild(n)}))}(),t.preventDefault()}))))},711:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.AttendanceService=void 0;const d=n(674),s=n(669);e.AttendanceService=class{constructor(){this.attendances=[],this.studentAttendances=[],this.sequence=1}getAttendanceList(){return this.attendances}getAttendance(t){return this.attendances.filter((e=>e.id===t))[0]}getStudentAttendances(){return this.studentAttendances}getAttendancesByAttendanceId(t){return this.studentAttendances.filter((e=>e.getAttendance().id===t))}getAttendancesByStudentId(t){return this.studentAttendances.filter((e=>e.getStudent().id===t))}takeAttendance(t,e){const n=new d.Attendance(this.sequence++,t);this.attendances.push(n),e.forEach(((t,e)=>{const d=new s.StudentAttendance(e,n,t);t||e.increaseAbsent(),this.studentAttendances.push(d)}))}}},287:function(t,e,n){var d=this&&this.__awaiter||function(t,e,n,d){return new(n||(n=Promise))((function(s,i){function o(t){try{c(d.next(t))}catch(t){i(t)}}function a(t){try{c(d.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?s(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}c((d=d.apply(t,e||[])).next())}))},s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.StudentService=void 0;const i=n(406),o=s(n(300));var a="http://localhost:3002/api/v1";e.StudentService=class{constructor(){this._students=[],this._sequence=1,this.getStudents()}getStudents(){return d(this,void 0,void 0,(function*(){const t=yield(0,o.default)(a+"/students",{method:"GET",headers:{Accept:"application/json"}});if(!t.ok)throw new Error(`Error! status: ${t.status}`);const e=yield t.json();return this._students=JSON.parse(JSON.stringify(e)),this._students}))}addStudent(t,e){return d(this,void 0,void 0,(function*(){const n=yield(0,o.default)(a+"/students/"+t+"/"+e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:t,surname:e,absent:0})});if(!n.ok)throw new Error(`Error! status: ${n.status}`);const d=yield n.json();console.log("result is: ",JSON.stringify(d));const s=new i.Student(this._sequence,t,e);this._students.push(s)}))}getStudent(t){return window.fetch(a+"students"+t,{method:"GET"}).then((t=>t.json())).then((t=>{console.log(t)})),this._students.find((e=>e.id===t))}updateStudent(t,e,n){return d(this,void 0,void 0,(function*(){const d=yield(0,o.default)(a+"/students/"+t+"/"+e+"/"+n,{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({id:t,name:e,surname:n})});if(!d.ok)throw new Error(`Error! status: ${d.status}`);const s=yield d.json();console.log("result is: ",JSON.stringify(s));const i=this.getStudent(t);i&&(i.setName(e),i.setSurname(n))}))}deleteStudent(t){return d(this,void 0,void 0,(function*(){const e=yield(0,o.default)(a+"/students/"+t,{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!e.ok)throw new Error(`Error! status: ${e.status}`);const n=yield e.json();console.log("result is: ",JSON.stringify(n));const d=this._students.filter((e=>e.id!==t));this._students=d}))}}}},e={};!function n(d){var s=e[d];if(void 0!==s)return s.exports;var i=e[d]={exports:{}};return t[d].call(i.exports,i,i.exports,n),i.exports}(607)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LElBQUkzSCxNQUFNLGtCQUFrQnVILEVBQVNLLFVBRy9DLE1BQU1DLFFBQWVOLEVBQVNPLE9BQzlCdkcsUUFBUUMsSUFBSSxjQUFldUcsS0FBS0UsVUFBVUosSUFDMUMsTUFBTTdGLEVBQVVqQixLQUFLcUIsV0FBVzJFLEdBQzVCL0UsSUFDQUEsRUFBUUgsUUFBUUosR0FDaEJPLEVBQVFGLFdBQVdKLEdBRTNCLEcsQ0FFTWtELGNBQWNtQyxHLHlDQUNoQixNQUFNUSxRQUFpQixhQUFNSCxFQUFTLGFBQWVMLEVBQVcsQ0FDNURTLE9BQVEsU0FDUkMsUUFBUyxDQUNMQyxPQUFRLG1CQUNSLGVBQWdCLHNCQUl4QixJQUFLSCxFQUFTSSxHQUNWLE1BQU0sSUFBSTNILE1BQU0sa0JBQWtCdUgsRUFBU0ssVUFHL0MsTUFBTUMsUUFBZU4sRUFBU08sT0FFOUJ2RyxRQUFRQyxJQUFJLGNBQWV1RyxLQUFLRSxVQUFVSixJQUMxQyxNQUFNUyxFQUFXdkgsS0FBS3NHLFVBQVVYLFFBQU8xRSxHQUFXQSxFQUFRdEIsS0FBT3FHLElBQ2pFaEcsS0FBS3NHLFVBQVlpQixDQUNyQixHLEtDOUdBQyxFQUEyQixDQUFDLEdBR2hDLFNBQVNDLEVBQW9CQyxHQUU1QixJQUFJQyxFQUFlSCxFQUF5QkUsR0FDNUMsUUFBcUJFLElBQWpCRCxFQUNILE9BQU9BLEVBQWF2SSxRQUdyQixJQUFJRCxFQUFTcUksRUFBeUJFLEdBQVksQ0FHakR0SSxRQUFTLENBQUMsR0FPWCxPQUhBeUksRUFBb0JILEdBQVVJLEtBQUszSSxFQUFPQyxRQUFTRCxFQUFRQSxFQUFPQyxRQUFTcUksR0FHcEV0SSxFQUFPQyxPQUNmLENDbkIwQnFJLENBQW9CLEkiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90eXMvLi9ub2RlX21vZHVsZXMvbm9kZS1mZXRjaC9icm93c2VyLmpzIiwid2VicGFjazovL3R5cy8uL3NyYy9kb21haW4vYXR0ZW5kYW5jZS50cyIsIndlYnBhY2s6Ly90eXMvLi9zcmMvZG9tYWluL3N0dWRlbnQudHMiLCJ3ZWJwYWNrOi8vdHlzLy4vc3JjL2RvbWFpbi9zdHVkZW50X2F0dGVuZGFuY2UudHMiLCJ3ZWJwYWNrOi8vdHlzLy4vc3JjL2luZGV4LnRzIiwid2VicGFjazovL3R5cy8uL3NyYy9zZXJ2aWNlL2F0dGVuZGFuY2Vfc2VydmljZS50cyIsIndlYnBhY2s6Ly90eXMvLi9zcmMvc2VydmljZS9zdHVkZW50X3NlcnZpY2UudHMiLCJ3ZWJwYWNrOi8vdHlzL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL3R5cy93ZWJwYWNrL3N0YXJ0dXAiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5cbi8vIHJlZjogaHR0cHM6Ly9naXRodWIuY29tL3RjMzkvcHJvcG9zYWwtZ2xvYmFsXG52YXIgZ2V0R2xvYmFsID0gZnVuY3Rpb24gKCkge1xuXHQvLyB0aGUgb25seSByZWxpYWJsZSBtZWFucyB0byBnZXQgdGhlIGdsb2JhbCBvYmplY3QgaXNcblx0Ly8gYEZ1bmN0aW9uKCdyZXR1cm4gdGhpcycpKClgXG5cdC8vIEhvd2V2ZXIsIHRoaXMgY2F1c2VzIENTUCB2aW9sYXRpb25zIGluIENocm9tZSBhcHBzLlxuXHRpZiAodHlwZW9mIHNlbGYgIT09ICd1bmRlZmluZWQnKSB7IHJldHVybiBzZWxmOyB9XG5cdGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJykgeyByZXR1cm4gd2luZG93OyB9XG5cdGlmICh0eXBlb2YgZ2xvYmFsICE9PSAndW5kZWZpbmVkJykgeyByZXR1cm4gZ2xvYmFsOyB9XG5cdHRocm93IG5ldyBFcnJvcigndW5hYmxlIHRvIGxvY2F0ZSBnbG9iYWwgb2JqZWN0Jyk7XG59XG5cbnZhciBnbG9iYWwgPSBnZXRHbG9iYWwoKTtcblxubW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzID0gZ2xvYmFsLmZldGNoO1xuXG4vLyBOZWVkZWQgZm9yIFR5cGVTY3JpcHQgYW5kIFdlYnBhY2suXG5pZiAoZ2xvYmFsLmZldGNoKSB7XG5cdGV4cG9ydHMuZGVmYXVsdCA9IGdsb2JhbC5mZXRjaC5iaW5kKGdsb2JhbCk7XG59XG5cbmV4cG9ydHMuSGVhZGVycyA9IGdsb2JhbC5IZWFkZXJzO1xuZXhwb3J0cy5SZXF1ZXN0ID0gZ2xvYmFsLlJlcXVlc3Q7XG5leHBvcnRzLlJlc3BvbnNlID0gZ2xvYmFsLlJlc3BvbnNlOyIsImV4cG9ydCBjbGFzcyBBdHRlbmRhbmNlIHtcbiAgICBpZDogbnVtYmVyO1xuICAgIHByYXllclRpbWU6IHN0cmluZztcbiAgICBkYXRlOiBEYXRlID0gbmV3IERhdGUoKTtcblxuICAgIHRvZGF5ID0gdGhpcy5kYXRlLmdldERhdGUoKSArIFwiL1wiICsgKHRoaXMuZGF0ZS5nZXRNb250aCgpICsgMSkgKyBcIi9cIiArIHRoaXMuZGF0ZS5nZXRGdWxsWWVhcigpICsgXCIgXCIgKyB0aGlzLmRhdGUuZ2V0SG91cnMoKSArIFwiOlwiICsgdGhpcy5kYXRlLmdldE1pbnV0ZXMoKSArIFwiOlwiICsgdGhpcy5kYXRlLmdldFNlY29uZHMoKTtcblxuICAgIGNvbnN0cnVjdG9yKGlkOiBudW1iZXIsIHByYXllclRpbWU6IHN0cmluZykge1xuICAgICAgICB0aGlzLmlkID0gaWQ7XG4gICAgICAgIHRoaXMucHJheWVyVGltZSA9IHByYXllclRpbWU7XG4gICAgfVxuXG4gICAgc2hvd0luZm9BdHRlbmRhbmNlKCkge1xuICAgICAgICBjb25zb2xlLmxvZyh0aGlzLmlkICsgXCIgXCIgKyB0aGlzLnByYXllclRpbWUgKyBcIiBcIiArIHRoaXMudG9kYXkpO1xuICAgIH1cbn0iLCJleHBvcnQgY2xhc3MgU3R1ZGVudCB7XG4gICAgaWQ6IG51bWJlcjtcbiAgICBuYW1lOiBzdHJpbmc7XG4gICAgc3VybmFtZTogc3RyaW5nO1xuICAgIGFic2VudDogbnVtYmVyO1xuXG4gICAgY29uc3RydWN0b3IoaWQ6IG51bWJlciwgbmFtZTogc3RyaW5nLCBzdXJuYW1lOiBzdHJpbmcpIHtcbiAgICAgICAgdGhpcy5pZCA9IGlkO1xuICAgICAgICB0aGlzLm5hbWUgPSBuYW1lO1xuICAgICAgICB0aGlzLnN1cm5hbWUgPSBzdXJuYW1lO1xuICAgICAgICB0aGlzLmFic2VudCA9IDA7XG4gICAgfVxuICAgIGluY3JlYXNlQWJzZW50KCkge1xuICAgICAgICB0aGlzLmFic2VudCA9IHRoaXMuYWJzZW50ICsgMTtcbiAgICB9XG5cbiAgICBzZXROYW1lKG5hbWU6IHN0cmluZykge1xuICAgICAgICB0aGlzLm5hbWUgPSBuYW1lO1xuICAgIH1cbiAgICBzZXRTdXJuYW1lKHN1cm5hbWU6IHN0cmluZykge1xuICAgICAgICB0aGlzLnN1cm5hbWUgPSBzdXJuYW1lO1xuICAgIH1cblxuICAgIHNob3dJbmZvU3R1ZGVudCgpIHtcbiAgICAgICAgY29uc29sZS5sb2codGhpcy5uYW1lICsgXCIgXCIgKyB0aGlzLnN1cm5hbWUgKyBcIiBcIiArIHRoaXMuYWJzZW50KTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBTdHVkZW50IH0gZnJvbSBcIi4vc3R1ZGVudFwiO1xuaW1wb3J0IHsgQXR0ZW5kYW5jZSB9IGZyb20gXCIuL2F0dGVuZGFuY2VcIjtcbmV4cG9ydCBjbGFzcyBTdHVkZW50QXR0ZW5kYW5jZSB7XG4gICAgc3R1ZGVudDogU3R1ZGVudDtcbiAgICBhdHRlbmRhbmNlOiBBdHRlbmRhbmNlO1xuICAgIGlzQWJzZW5jZTogQm9vbGVhbjtcblxuICAgIGNvbnN0cnVjdG9yKHN0dWRlbnQ6IFN0dWRlbnQsIGF0dGVuZGFuY2U6IEF0dGVuZGFuY2UsIGlzQWJzZW5jZTogQm9vbGVhbikge1xuICAgICAgICB0aGlzLnN0dWRlbnQgPSBzdHVkZW50O1xuICAgICAgICB0aGlzLmF0dGVuZGFuY2UgPSBhdHRlbmRhbmNlO1xuICAgICAgICB0aGlzLmlzQWJzZW5jZSA9IGlzQWJzZW5jZTtcbiAgICB9XG5cbiAgICBnZXRBdHRlbmRhbmNlKCk6QXR0ZW5kYW5jZXtcbiAgICAgICAgcmV0dXJuIHRoaXMuYXR0ZW5kYW5jZTtcbiAgICB9XG4gICAgZ2V0U3R1ZGVudCgpOlN0dWRlbnR7XG4gICAgICAgIHJldHVybiB0aGlzLnN0dWRlbnQ7XG4gICAgfVxuXG4gICAgZ2V0SXNBYnNlbmNlVG9TdHJpbmcoaXNBYnNlbmNlOiBib29sZWFuKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIGlzQWJzZW5jZSA/IFwiVmFyXCIgOiBcIllva1wiO1xuICAgIH1cblxuICAgIHNob3dJbmZvU3R1ZGVudEF0dGVuZGFuY2UoKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKHRoaXMuc3R1ZGVudCArIFwiIFwiICsgdGhpcy5hdHRlbmRhbmNlICsgXCIgXCIgKyB0aGlzLmdldElzQWJzZW5jZVRvU3RyaW5nKTtcbiAgICB9XG59IiwiaW1wb3J0IHsgU3R1ZGVudFNlcnZpY2UgfSBmcm9tIFwiLi9zZXJ2aWNlL3N0dWRlbnRfc2VydmljZVwiO1xuaW1wb3J0IHsgQXR0ZW5kYW5jZVNlcnZpY2UgfSBmcm9tIFwiLi9zZXJ2aWNlL2F0dGVuZGFuY2Vfc2VydmljZVwiO1xuaW1wb3J0IHsgU3R1ZGVudCB9IGZyb20gXCIuL2RvbWFpbi9zdHVkZW50XCI7XG5pbXBvcnQgeyBBdHRlbmRhbmNlIH0gZnJvbSBcIi4vZG9tYWluL2F0dGVuZGFuY2VcIjtcblxuY29uc3Qgc3R1ZGVudFNlcnZpY2UgPSBuZXcgU3R1ZGVudFNlcnZpY2UoKTtcbmNvbnN0IGF0dGVuZGFuY2VTZXJ2aWNlID0gbmV3IEF0dGVuZGFuY2VTZXJ2aWNlKCk7XG5cbmNvbnN0IGFkZFN0dWRlbnRCdXR0b24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImFkZFN0dWRlbnRCdXR0b25cIikgYXMgSFRNTEJ1dHRvbkVsZW1lbnQ7XG5jb25zdCB1cGRhdGVTdHVkZW50QnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ1cGRhdGVTdHVkZW50QnV0dG9uXCIpIGFzIEhUTUxCdXR0b25FbGVtZW50O1xuY29uc3QgdGFrZUF0dGVuZGFuY2VCdXR0b24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInRha2VBdHRlbmRhbmNlQnV0dG9uXCIpIGFzIEhUTUxCdXR0b25FbGVtZW50O1xuXG5jb25zdCBuYW1lSW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIm5hbWVJbnB1dFwiKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xuY29uc3Qgc3VybmFtZUlucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJzdXJuYW1lSW5wdXRcIikgYXMgSFRNTElucHV0RWxlbWVudDtcblxuY29uc3Qgc2VsZWN0UHJheWVyVGltZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwic2VsZWN0UHJheWVyVGltZVwiKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xuY29uc3Qgc2VsZWN0TGlzdCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlOYW1lKFwic2VsZWN0QWJzZW5jZVwiKSBhcyBOb2RlTGlzdE9mPEhUTUxTZWxlY3RFbGVtZW50PjtcbmNvbnN0IG15U2VsZWN0QXR0ZW5kYW5jZUlkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJzZWxlY3RMaXN0V2l0aEF0dGVuZGFuY2VJZFwiKSBhcyBIVE1MVGFibGVTZWN0aW9uRWxlbWVudDtcbmNvbnN0IG15U2VsZWN0U3R1ZGVudElkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJteVNlbGVjdFN0dWRlbnRJZFwiKSBhcyBIVE1MVGFibGVTZWN0aW9uRWxlbWVudDtcblxuY29uc3Qgc3R1ZGVudFRhYmxlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJzdHVkZW50TGlzdEJvZHlcIikgYXMgSFRNTFRhYmxlRWxlbWVudDtcbmNvbnN0IHRha2VBdHRlbmRhbmNlVGFibGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInRha2VBdHRlbmRhbmNlQm9keVwiKSBhcyBIVE1MVGFibGVFbGVtZW50O1xuY29uc3QgdGJvZHlMaXN0Rm9yQXR0ZW5kYW5jZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidGJvZHlMaXN0Rm9yQXR0ZW5kYW5jZVwiKSBhcyBIVE1MVGFibGVTZWN0aW9uRWxlbWVudDtcblxuXG5sZXQgc2VsZWN0ZWRTdHVkZW50OiBTdHVkZW50O1xuc2hvd0xpc3RzKCk7XG5cbmFkZFN0dWRlbnRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGFzeW5jIChlKSA9PiB7XG4gIGUucHJldmVudERlZmF1bHQoKTtcbiAgY29uc29sZS5sb2coXCJFa2xlbWVcIik7XG4gIGF3YWl0IHN0dWRlbnRTZXJ2aWNlLmFkZFN0dWRlbnQobmFtZUlucHV0LnZhbHVlLCBzdXJuYW1lSW5wdXQudmFsdWUpO1xuICBuYW1lSW5wdXQudmFsdWUgPSBcIlwiO1xuICBzdXJuYW1lSW5wdXQudmFsdWUgPSBcIlwiO1xuICBzaG93TGlzdHMoKTtcbn0pO1xuXG51cGRhdGVTdHVkZW50QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBhc3luYyAoZSkgPT4ge1xuICBjb25zb2xlLmxvZyhcIkfDvG5jZWxsZW1lXCIpO1xuICBhd2FpdCBzdHVkZW50U2VydmljZS51cGRhdGVTdHVkZW50KHNlbGVjdGVkU3R1ZGVudC5pZCwgbmFtZUlucHV0LnZhbHVlLCBzdXJuYW1lSW5wdXQudmFsdWUpO1xuICBuYW1lSW5wdXQudmFsdWUgPSBcIlwiO1xuICBzdXJuYW1lSW5wdXQudmFsdWUgPSBcIlwiO1xuICBzaG93TGlzdHMoKTtcbiAgYWRkU3R1ZGVudEJ1dHRvbi5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xuICB1cGRhdGVTdHVkZW50QnV0dG9uLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcbiAgZS5wcmV2ZW50RGVmYXVsdCgpO1xufSk7XG5cbnRha2VBdHRlbmRhbmNlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBhc3luYyAoZSkgPT4ge1xuICBjb25zb2xlLmxvZyhcIllva2xhbWEgYWxtYVwiKTtcbiAgY29uc3QgbWFwID0gbmV3IE1hcCgpO1xuIChhd2FpdCBzdHVkZW50U2VydmljZS5nZXRTdHVkZW50cygpKS5mb3JFYWNoKChzdHVkZW50OiBTdHVkZW50LCBpbmRleDogbnVtYmVyKSA9PiB7XG4gICAgbWFwLnNldChzdHVkZW50LCBzZWxlY3RMaXN0W2luZGV4XS52YWx1ZSA9PT0gXCIrXCIpO1xuICB9KVxuICBhdHRlbmRhbmNlU2VydmljZS50YWtlQXR0ZW5kYW5jZShzZWxlY3RQcmF5ZXJUaW1lLnZhbHVlLCBtYXApO1xuICBjb25zb2xlLmxvZyhhdHRlbmRhbmNlU2VydmljZS5nZXRBdHRlbmRhbmNlTGlzdCgpKTtcbiAgc2hvd0xpc3RzKCk7XG4gIGxpc3RXaXRoQXR0ZW5kYW5jZUlkKCk7XG4gIC8vIGxpc3RTdHVkZW50c0ZvckF0dGVuZGFuY2UoKTtcbiAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG59KTtcblxuXG5mdW5jdGlvbiBzaG93TGlzdHMoKSB7XG5cbiAgc2hvd1N0dWRlbnRMaXN0KCk7XG4gIHNob3dBdHRlbmRhbmNlTGlzdCgpO1xufVxuLyoqXG4gKiDDlsSfcmVuY2kgbGlzdGVzaW5pIGVrcmFuYSB5YXpkxLFybWEgKHRhYmxvZGEpXG4gKi9cbiBhc3luYyBmdW5jdGlvbiBzaG93U3R1ZGVudExpc3QoKSB7XG4gIHN0dWRlbnRUYWJsZS5pbm5lckhUTUwgPSBcIlwiO1xuICAoYXdhaXQgc3R1ZGVudFNlcnZpY2UuZ2V0U3R1ZGVudHMoKSkuZm9yRWFjaCgoc3R1ZGVudDogU3R1ZGVudCkgPT4ge1xuICAgIGNvbnN0IHRyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInRyXCIpO1xuICAgIGNvbnN0IHRkSWQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwidGRcIik7XG4gICAgY29uc3QgdGROYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInRkXCIpO1xuICAgIGNvbnN0IHRkU3VybmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJ0ZFwiKTtcbiAgICBjb25zdCB0ZEFic2VudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJ0ZFwiKTtcbiAgICBjb25zdCB0ZERlbGV0ZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJ0ZFwiKTtcbiAgICBjb25zdCB0ZFVwZGF0ZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJ0ZFwiKTtcbiAgICBjb25zdCB0ZEJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJ0ZFwiKTtcbiAgICBjb25zdCBkZWxldGVCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYnV0dG9uXCIpO1xuICAgIGNvbnN0IHVwZGF0ZUJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIik7XG5cbiAgICB0ZElkLmlubmVySFRNTCA9IHN0dWRlbnQuaWQudG9TdHJpbmcoKTtcbiAgICB0ZE5hbWUuaW5uZXJUZXh0ID0gc3R1ZGVudC5uYW1lO1xuICAgIHRkU3VybmFtZS5pbm5lclRleHQgPSBzdHVkZW50LnN1cm5hbWU7XG4gICAgdGRBYnNlbnQuaW5uZXJUZXh0ID0gc3R1ZGVudC5hYnNlbnQudG9TdHJpbmcoKTtcbiAgICBkZWxldGVCdXR0b24uc2V0QXR0cmlidXRlKFwiY2xhc3NcIiwgXCJidG4gYnRuLWRhbmdlclwiKTtcbiAgICBkZWxldGVCdXR0b24uc2V0QXR0cmlidXRlKFwiaWRcIiwgXCJkZWxldGVCdXR0b25cIik7XG4gICAgZGVsZXRlQnV0dG9uLnNldEF0dHJpYnV0ZShcImRhdGEtaWRcIiwgc3R1ZGVudC5pZC50b1N0cmluZygpKTtcbiAgICBkZWxldGVCdXR0b24uaW5uZXJIVE1MID0gJzxpIGNsYXNzPVwiZmFzIGZhLXRyYXNoLWFsdFwiPjwvaT4nO1xuICAgIHVwZGF0ZUJ1dHRvbi5zZXRBdHRyaWJ1dGUoXCJjbGFzc1wiLCBcImJ0biBidG4tcHJpbWFyeVwiKTtcbiAgICB1cGRhdGVCdXR0b24uc2V0QXR0cmlidXRlKFwiaWRcIiwgXCJ1cGRhdGVCdXR0b25cIik7XG4gICAgdXBkYXRlQnV0dG9uLnNldEF0dHJpYnV0ZShcImRhdGEtaWRcIiwgc3R1ZGVudC5pZC50b1N0cmluZygpKTtcbiAgICB1cGRhdGVCdXR0b24uaW5uZXJIVE1MID0gJzxpIGNsYXNzPVwiZmEtc29saWQgZmEtZWRpdFwiPjwvaT4nO1xuICAgIHRkRGVsZXRlLmFwcGVuZENoaWxkKGRlbGV0ZUJ1dHRvbik7XG4gICAgdGRVcGRhdGUuYXBwZW5kQ2hpbGQodXBkYXRlQnV0dG9uKTtcbiAgICB0ci5hcHBlbmRDaGlsZCh0ZElkKTtcbiAgICB0ci5hcHBlbmRDaGlsZCh0ZE5hbWUpO1xuICAgIHRyLmFwcGVuZENoaWxkKHRkU3VybmFtZSk7XG4gICAgdHIuYXBwZW5kQ2hpbGQodGRBYnNlbnQpO1xuICAgIHRkQnV0dG9uLmFwcGVuZENoaWxkKHRkRGVsZXRlKTtcbiAgICB0ZEJ1dHRvbi5hcHBlbmRDaGlsZCh0ZFVwZGF0ZSk7XG4gICAgdGRCdXR0b24uc2V0QXR0cmlidXRlKFwiY2xhc3NcIiwgXCJkLWZsZXgganVzdGlmeS1jb250ZW50LWFyb3VuZFwiKTtcbiAgICB0ci5hcHBlbmRDaGlsZCh0ZEJ1dHRvbik7XG4gICAgc3R1ZGVudFRhYmxlLmFwcGVuZENoaWxkKHRyKTtcblxuICAgIGRlbGV0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiAsICgpID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKFwiU2lsbWVcIik7XG4gICAgICBzdHVkZW50U2VydmljZS5kZWxldGVTdHVkZW50KE51bWJlcihkZWxldGVCdXR0b24uZGF0YXNldC5pZCkpO1xuICAgICAgc2hvd0xpc3RzKCk7XG4gICAgfSk7XG4gICAgdXBkYXRlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICBzZWxlY3RlZFN0dWRlbnQgPSBzdHVkZW50O1xuICAgICAgbmFtZUlucHV0LnZhbHVlID0gc2VsZWN0ZWRTdHVkZW50Lm5hbWU7XG4gICAgICBzdXJuYW1lSW5wdXQudmFsdWUgPSBzZWxlY3RlZFN0dWRlbnQuc3VybmFtZTtcbiAgICAgIGFkZFN0dWRlbnRCdXR0b24uc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuICAgICAgdXBkYXRlU3R1ZGVudEJ1dHRvbi5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xuICAgICAgdXBkYXRlU3R1ZGVudEJ1dHRvbi5zZXRBdHRyaWJ1dGUoXCJkYXRhLWlkXCIsIHNlbGVjdGVkU3R1ZGVudC5pZC50b1N0cmluZygpKTtcbiAgICB9KTtcbiAgfSk7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIHNob3dBdHRlbmRhbmNlTGlzdCgpIHtcbiAgdGFrZUF0dGVuZGFuY2VUYWJsZS5pbm5lckhUTUwgPSBcIlwiO1xuICAoYXdhaXQgc3R1ZGVudFNlcnZpY2UuZ2V0U3R1ZGVudHMoKSkuZm9yRWFjaCgoc3R1ZGVudDogeyBpZDogeyB0b1N0cmluZzogKCkgPT4gc3RyaW5nOyB9OyBuYW1lOiBzdHJpbmc7IHN1cm5hbWU6IHN0cmluZzsgfSkgPT4ge1xuICAgIGNvbnN0IHRyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInRyXCIpO1xuICAgIGNvbnN0IHRkSWQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwidGRcIik7XG4gICAgY29uc3QgdGROYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInRkXCIpO1xuICAgIGNvbnN0IHRkU3VybmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJ0ZFwiKTtcbiAgICBjb25zdCB0ZE9wdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJ0ZFwiKTtcbiAgICBjb25zdCBzZWxlY3QgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic2VsZWN0XCIpO1xuICAgIGNvbnN0IG9wdGlvbjEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwib3B0aW9uXCIpO1xuICAgIGNvbnN0IG9wdGlvbjIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwib3B0aW9uXCIpO1xuXG4gICAgdGRJZC5pbm5lckhUTUwgPSBzdHVkZW50LmlkLnRvU3RyaW5nKCk7XG4gICAgdGROYW1lLmlubmVyVGV4dCA9IHN0dWRlbnQubmFtZTtcbiAgICB0ZFN1cm5hbWUuaW5uZXJUZXh0ID0gc3R1ZGVudC5zdXJuYW1lO1xuICAgIHNlbGVjdC5zZXRBdHRyaWJ1dGUoXCJjbGFzc1wiLCBcImZvcm0tc2VsZWN0XCIpO1xuICAgIHNlbGVjdC5zZXRBdHRyaWJ1dGUoXCJuYW1lXCIsIFwic2VsZWN0QWJzZW5jZVwiKTtcbiAgICBzZWxlY3Quc2V0QXR0cmlidXRlKFwiYXJpYS1sYWJlbFwiLCBcInNlbGVjdCBleGFtcGxlXCIpO1xuICAgIG9wdGlvbjEuc2V0QXR0cmlidXRlKFwidmFsdWVcIiwgXCIrXCIpO1xuICAgIG9wdGlvbjIuc2V0QXR0cmlidXRlKFwidmFsdWVcIiwgXCItXCIpO1xuICAgIG9wdGlvbjEuaW5uZXJUZXh0ID0gXCIrXCI7XG4gICAgb3B0aW9uMi5pbm5lclRleHQgPSBcIi1cIjtcblxuICAgIHNlbGVjdC5hcHBlbmRDaGlsZChvcHRpb24xKTtcbiAgICBzZWxlY3QuYXBwZW5kQ2hpbGQob3B0aW9uMik7XG4gICAgdGRPcHRpb24uYXBwZW5kQ2hpbGQoc2VsZWN0KTtcbiAgICB0ci5hcHBlbmRDaGlsZCh0ZElkKTtcbiAgICB0ci5hcHBlbmRDaGlsZCh0ZE5hbWUpO1xuICAgIHRyLmFwcGVuZENoaWxkKHRkU3VybmFtZSk7XG4gICAgdHIuYXBwZW5kQ2hpbGQodGRPcHRpb24pO1xuICAgIHRha2VBdHRlbmRhbmNlVGFibGUuYXBwZW5kQ2hpbGQodHIpO1xuICB9KTtcbn1cblxuZnVuY3Rpb24gbGlzdFdpdGhBdHRlbmRhbmNlSWQoKSB7XG4gIGNvbnN0IGF0dGVuZGFuY2VMaXN0ID0gYXR0ZW5kYW5jZVNlcnZpY2UuZ2V0QXR0ZW5kYW5jZUxpc3QoKTtcbiAgY29uc3Qgc2VsZWN0TGlzdFdpdGhBdHRlbmRhbmNlSWQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInNlbGVjdExpc3RXaXRoQXR0ZW5kYW5jZUlkXCIpIGFzIEhUTUxUYWJsZVNlY3Rpb25FbGVtZW50O1xuICBzZWxlY3RMaXN0V2l0aEF0dGVuZGFuY2VJZC5pbm5lckhUTUwgPSBcIlwiO1xuICBjb25zdCBvcHRpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwib3B0aW9uXCIpO1xuICBvcHRpb24uc2V0QXR0cmlidXRlKFwiZGlzYWJsZWRcIiwgXCJkaXNhYmxlZFwiKTtcbiAgb3B0aW9uLmlubmVyVGV4dCA9IFwiTMO8dGZlbiBMaXN0ZWxlbWVrIMSwc3RlZMSfaW5peiBWYWt0aSBTZcOnaW5pei4uLlwiO1xuICBzZWxlY3RMaXN0V2l0aEF0dGVuZGFuY2VJZC5hcHBlbmRDaGlsZChvcHRpb24pO1xuICBhdHRlbmRhbmNlTGlzdC5mb3JFYWNoKChhdHRlbmRhbmNlKSA9PiB7XG4gICAgY29uc3Qgb3B0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcIm9wdGlvblwiKTtcbiAgICBvcHRpb24uc2V0QXR0cmlidXRlKFwidmFsdWVcIiwgYXR0ZW5kYW5jZS5pZC50b1N0cmluZygpKTtcbiAgICBvcHRpb24uaW5uZXJUZXh0ID0gYXR0ZW5kYW5jZS50b2RheSArIFwiIFwiICsgYXR0ZW5kYW5jZS5wcmF5ZXJUaW1lO1xuICAgIHNlbGVjdExpc3RXaXRoQXR0ZW5kYW5jZUlkLmFwcGVuZENoaWxkKG9wdGlvbik7XG5cbiAgfSk7XG59XG4iLCJpbXBvcnQge1N0dWRlbnR9IGZyb20gXCIuLi9kb21haW4vc3R1ZGVudFwiO1xuaW1wb3J0IHtBdHRlbmRhbmNlfSBmcm9tIFwiLi4vZG9tYWluL2F0dGVuZGFuY2VcIjtcbmltcG9ydCB7U3R1ZGVudEF0dGVuZGFuY2V9IGZyb20gXCIuLi9kb21haW4vc3R1ZGVudF9hdHRlbmRhbmNlXCI7XG5cbmV4cG9ydCBjbGFzcyBBdHRlbmRhbmNlU2VydmljZSB7XG4gICAgYXR0ZW5kYW5jZXM6IEFycmF5PEF0dGVuZGFuY2U+ID0gW107XG4gICAgc3R1ZGVudEF0dGVuZGFuY2VzOiBBcnJheTxTdHVkZW50QXR0ZW5kYW5jZT4gPSBbXTtcbiAgICBzZXF1ZW5jZTogbnVtYmVyID0gMTtcblxuICAgIGdldEF0dGVuZGFuY2VMaXN0KCk6IEFycmF5PEF0dGVuZGFuY2U+IHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYXR0ZW5kYW5jZXM7XG4gICAgfVxuXG4gICAgZ2V0QXR0ZW5kYW5jZShhdHRlbmRhbmNlSWQ6IG51bWJlcik6IEF0dGVuZGFuY2Uge1xuICAgICAgICByZXR1cm4gdGhpcy5hdHRlbmRhbmNlcy5maWx0ZXIoXG4gICAgICAgICAgICAoYXR0ZW5kYW5jZSkgPT4gYXR0ZW5kYW5jZS5pZCA9PT0gYXR0ZW5kYW5jZUlkKVswXTtcbiAgICB9XG5cbiAgICBnZXRTdHVkZW50QXR0ZW5kYW5jZXMoKTogQXJyYXk8U3R1ZGVudEF0dGVuZGFuY2U+IHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc3R1ZGVudEF0dGVuZGFuY2VzO1xuICAgIH1cblxuICAgIGdldEF0dGVuZGFuY2VzQnlBdHRlbmRhbmNlSWQoYXR0ZW5kYW5jZUlkOiBudW1iZXIpOiBBcnJheTxTdHVkZW50QXR0ZW5kYW5jZT4ge1xuICAgICAgICByZXR1cm4gdGhpcy5zdHVkZW50QXR0ZW5kYW5jZXMuZmlsdGVyKFxuICAgICAgICAgICAgKHN0dWRlbnRBdHRlbmRhbmNlKSA9PlxuICAgICAgICAgICAgICAgIHN0dWRlbnRBdHRlbmRhbmNlLmdldEF0dGVuZGFuY2UoKS5pZCA9PT0gYXR0ZW5kYW5jZUlkKTtcbiAgICB9XG5cbiAgICBnZXRBdHRlbmRhbmNlc0J5U3R1ZGVudElkKHN0dWRlbnRJZDogbnVtYmVyKTogQXJyYXk8U3R1ZGVudEF0dGVuZGFuY2U+IHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc3R1ZGVudEF0dGVuZGFuY2VzLmZpbHRlcihcbiAgICAgICAgICAgIChzdHVkZW50QXR0ZW5kYW5jZSkgPT4gc3R1ZGVudEF0dGVuZGFuY2UuZ2V0U3R1ZGVudCgpLmlkID09PSBzdHVkZW50SWQpO1xuICAgIH1cblxuICAgIHRha2VBdHRlbmRhbmNlKHByYXllclRpbWU6IHN0cmluZywgYXR0ZW5kYW5jZU1hcDogTWFwPFN0dWRlbnQsIGJvb2xlYW4+KSB7XG4gICAgICAgIGNvbnN0IGF0dGVuZGFuY2UgPSBuZXcgQXR0ZW5kYW5jZSh0aGlzLnNlcXVlbmNlKyssIHByYXllclRpbWUpO1xuICAgICAgICB0aGlzLmF0dGVuZGFuY2VzLnB1c2goYXR0ZW5kYW5jZSk7XG5cbiAgICAgICAgYXR0ZW5kYW5jZU1hcC5mb3JFYWNoKChpc0Fic2VuY2UsIHN0dWRlbnQpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHN0dWRlbnRBdHRlbmRhbmNlID0gbmV3IFN0dWRlbnRBdHRlbmRhbmNlKHN0dWRlbnQsIGF0dGVuZGFuY2UsIGlzQWJzZW5jZSk7XG4gICAgICAgICAgICBpZiAoIWlzQWJzZW5jZSl7XG4gICAgICAgICAgICAgICAgc3R1ZGVudC5pbmNyZWFzZUFic2VudCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5zdHVkZW50QXR0ZW5kYW5jZXMucHVzaChzdHVkZW50QXR0ZW5kYW5jZSk7XG4gICAgICAgIH0pO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IFN0dWRlbnQgfSBmcm9tIFwiLi4vZG9tYWluL3N0dWRlbnRcIjtcbmltcG9ydCBmZXRjaCBmcm9tICdub2RlLWZldGNoJztcblxudmFyIGFwaVVybDogc3RyaW5nID0gJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMi9hcGkvdjEnO1xuXG5leHBvcnQgY2xhc3MgU3R1ZGVudFNlcnZpY2Uge1xuICAgIHByaXZhdGUgX3N0dWRlbnRzOiBBcnJheTxTdHVkZW50PiA9IFtdO1xuICAgIHByaXZhdGUgX3NlcXVlbmNlOiBudW1iZXIgPSAxO1xuXG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMuZ2V0U3R1ZGVudHMoKTtcbiAgICB9XG5cbiAgICBhc3luYyBnZXRTdHVkZW50cygpOiBQcm9taXNlPFN0dWRlbnRbXT4ge1xuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGFwaVVybCArICcvc3R1ZGVudHMnLCB7XG4gICAgICAgICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgIEFjY2VwdDogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBFcnJvciEgc3RhdHVzOiAke3Jlc3BvbnNlLnN0YXR1c31gKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCByZXN1bHQgPSAoYXdhaXQgcmVzcG9uc2UuanNvbigpKTtcbiAgICAgICAgdGhpcy5fc3R1ZGVudHMgPSA8U3R1ZGVudFtdPkpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkocmVzdWx0KSk7XG4gICAgICAgIHJldHVybiB0aGlzLl9zdHVkZW50cztcbiAgICB9XG5cblxuICAgIGFzeW5jIGFkZFN0dWRlbnQobmFtZTogc3RyaW5nLCBzdXJuYW1lOiBzdHJpbmcpIHtcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChhcGlVcmwgKyAnL3N0dWRlbnRzJyArICcvJyArIG5hbWUgKyAnLycgKyBzdXJuYW1lLCB7XG4gICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgICAgICBuYW1lOiBuYW1lLFxuICAgICAgICAgICAgICAgIHN1cm5hbWU6IHN1cm5hbWUsXG4gICAgICAgICAgICAgICAgYWJzZW50OiAwXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBFcnJvciEgc3RhdHVzOiAke3Jlc3BvbnNlLnN0YXR1c31gKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgICAgICAgY29uc29sZS5sb2coJ3Jlc3VsdCBpczogJywgSlNPTi5zdHJpbmdpZnkocmVzdWx0KSk7XG4gICAgICAgIGNvbnN0IHN0dWRlbnQgPSBuZXcgU3R1ZGVudCh0aGlzLl9zZXF1ZW5jZSwgbmFtZSwgc3VybmFtZSk7XG4gICAgICAgIHRoaXMuX3N0dWRlbnRzLnB1c2goc3R1ZGVudCk7XG4gICAgfVxuXG5cbiAgICBnZXRTdHVkZW50KHN0dWRlbnRJZDogbnVtYmVyKTogU3R1ZGVudCB8IHVuZGVmaW5lZCB7XG4gICAgICAgIHdpbmRvdy5mZXRjaChhcGlVcmwgKyAnc3R1ZGVudHMnICsgc3R1ZGVudElkLCB7XG4gICAgICAgICAgICBtZXRob2Q6ICdHRVQnXG4gICAgICAgIH0pXG4gICAgICAgICAgICAudGhlbihyZXNwb25zZSA9PiByZXNwb25zZS5qc29uKCkpXG4gICAgICAgICAgICAudGhlbihqc29uID0+IHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhqc29uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICk7XG4gICAgICAgIHJldHVybiB0aGlzLl9zdHVkZW50cy5maW5kKHN0dWRlbnQgPT4gc3R1ZGVudC5pZCA9PT0gc3R1ZGVudElkKTtcbiAgICB9XG5cbiAgICBhc3luYyB1cGRhdGVTdHVkZW50KHN0dWRlbnRJZDogbnVtYmVyLCBuYW1lOiBzdHJpbmcsIHN1cm5hbWU6IHN0cmluZykge1xuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGFwaVVybCArICcvc3R1ZGVudHMvJyArIHN0dWRlbnRJZCArICcvJyArIG5hbWUgKyAnLycgKyBzdXJuYW1lLCB7XG4gICAgICAgICAgICBtZXRob2Q6ICdQVVQnLFxuICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgIEFjY2VwdDogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgICAgIGlkOiBzdHVkZW50SWQsXG4gICAgICAgICAgICAgICAgbmFtZTogbmFtZSxcbiAgICAgICAgICAgICAgICBzdXJuYW1lOiBzdXJuYW1lXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBFcnJvciEgc3RhdHVzOiAke3Jlc3BvbnNlLnN0YXR1c31gKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgICAgICAgY29uc29sZS5sb2coJ3Jlc3VsdCBpczogJywgSlNPTi5zdHJpbmdpZnkocmVzdWx0KSk7XG4gICAgICAgIGNvbnN0IHN0dWRlbnQgPSB0aGlzLmdldFN0dWRlbnQoc3R1ZGVudElkKTtcbiAgICAgICAgaWYgKHN0dWRlbnQpIHtcbiAgICAgICAgICAgIHN0dWRlbnQuc2V0TmFtZShuYW1lKTtcbiAgICAgICAgICAgIHN0dWRlbnQuc2V0U3VybmFtZShzdXJuYW1lKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGFzeW5jIGRlbGV0ZVN0dWRlbnQoc3R1ZGVudElkOiBudW1iZXIpIHtcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChhcGlVcmwgKyAnL3N0dWRlbnRzLycgKyBzdHVkZW50SWQsIHtcbiAgICAgICAgICAgIG1ldGhvZDogJ0RFTEVURScsXG4gICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICAgQWNjZXB0OiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgRXJyb3IhIHN0YXR1czogJHtyZXNwb25zZS5zdGF0dXN9YCk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG5cbiAgICAgICAgY29uc29sZS5sb2coJ3Jlc3VsdCBpczogJywgSlNPTi5zdHJpbmdpZnkocmVzdWx0KSk7XG4gICAgICAgIGNvbnN0IHN0dWRlbnRzID0gdGhpcy5fc3R1ZGVudHMuZmlsdGVyKHN0dWRlbnQgPT4gc3R1ZGVudC5pZCAhPT0gc3R1ZGVudElkKTtcbiAgICAgICAgdGhpcy5fc3R1ZGVudHMgPSBzdHVkZW50cztcbiAgICB9XG59XG4iLCIvLyBUaGUgbW9kdWxlIGNhY2hlXG52YXIgX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fID0ge307XG5cbi8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG5mdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuXHR2YXIgY2FjaGVkTW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXTtcblx0aWYgKGNhY2hlZE1vZHVsZSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0cmV0dXJuIGNhY2hlZE1vZHVsZS5leHBvcnRzO1xuXHR9XG5cdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG5cdHZhciBtb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdID0ge1xuXHRcdC8vIG5vIG1vZHVsZS5pZCBuZWVkZWRcblx0XHQvLyBubyBtb2R1bGUubG9hZGVkIG5lZWRlZFxuXHRcdGV4cG9ydHM6IHt9XG5cdH07XG5cblx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG5cdF9fd2VicGFja19tb2R1bGVzX19bbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG5cdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG5cdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbn1cblxuIiwiLy8gc3RhcnR1cFxuLy8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4vLyBUaGlzIGVudHJ5IG1vZHVsZSBpcyByZWZlcmVuY2VkIGJ5IG90aGVyIG1vZHVsZXMgc28gaXQgY2FuJ3QgYmUgaW5saW5lZFxudmFyIF9fd2VicGFja19leHBvcnRzX18gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDYwNyk7XG4iXSwibmFtZXMiOlsiZ2xvYmFsIiwic2VsZiIsIndpbmRvdyIsIkVycm9yIiwiZ2V0R2xvYmFsIiwibW9kdWxlIiwiZXhwb3J0cyIsImZldGNoIiwiYmluZCIsIkhlYWRlcnMiLCJSZXF1ZXN0IiwiUmVzcG9uc2UiLCJjb25zdHJ1Y3RvciIsImlkIiwicHJheWVyVGltZSIsImRhdGUiLCJEYXRlIiwidG9kYXkiLCJ0aGlzIiwiZ2V0RGF0ZSIsImdldE1vbnRoIiwiZ2V0RnVsbFllYXIiLCJnZXRIb3VycyIsImdldE1pbnV0ZXMiLCJnZXRTZWNvbmRzIiwic2hvd0luZm9BdHRlbmRhbmNlIiwiY29uc29sZSIsImxvZyIsIm5hbWUiLCJzdXJuYW1lIiwiYWJzZW50IiwiaW5jcmVhc2VBYnNlbnQiLCJzZXROYW1lIiwic2V0U3VybmFtZSIsInNob3dJbmZvU3R1ZGVudCIsInN0dWRlbnQiLCJhdHRlbmRhbmNlIiwiaXNBYnNlbmNlIiwiZ2V0QXR0ZW5kYW5jZSIsImdldFN0dWRlbnQiLCJnZXRJc0Fic2VuY2VUb1N0cmluZyIsInNob3dJbmZvU3R1ZGVudEF0dGVuZGFuY2UiLCJzdHVkZW50U2VydmljZSIsIlN0dWRlbnRTZXJ2aWNlIiwiYXR0ZW5kYW5jZVNlcnZpY2UiLCJBdHRlbmRhbmNlU2VydmljZSIsImFkZFN0dWRlbnRCdXR0b24iLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwidXBkYXRlU3R1ZGVudEJ1dHRvbiIsInRha2VBdHRlbmRhbmNlQnV0dG9uIiwibmFtZUlucHV0Iiwic3VybmFtZUlucHV0Iiwic2VsZWN0UHJheWVyVGltZSIsInNlbGVjdExpc3QiLCJnZXRFbGVtZW50c0J5TmFtZSIsInN0dWRlbnRUYWJsZSIsInRha2VBdHRlbmRhbmNlVGFibGUiLCJzZWxlY3RlZFN0dWRlbnQiLCJzaG93TGlzdHMiLCJpbm5lckhUTUwiLCJnZXRTdHVkZW50cyIsImZvckVhY2giLCJ0ciIsImNyZWF0ZUVsZW1lbnQiLCJ0ZElkIiwidGROYW1lIiwidGRTdXJuYW1lIiwidGRBYnNlbnQiLCJ0ZERlbGV0ZSIsInRkVXBkYXRlIiwidGRCdXR0b24iLCJkZWxldGVCdXR0b24iLCJ1cGRhdGVCdXR0b24iLCJ0b1N0cmluZyIsImlubmVyVGV4dCIsInNldEF0dHJpYnV0ZSIsImFwcGVuZENoaWxkIiwiYWRkRXZlbnRMaXN0ZW5lciIsImRlbGV0ZVN0dWRlbnQiLCJOdW1iZXIiLCJkYXRhc2V0IiwidmFsdWUiLCJzdHlsZSIsImRpc3BsYXkiLCJzaG93U3R1ZGVudExpc3QiLCJ0ZE9wdGlvbiIsInNlbGVjdCIsIm9wdGlvbjEiLCJvcHRpb24yIiwic2hvd0F0dGVuZGFuY2VMaXN0IiwiZSIsInByZXZlbnREZWZhdWx0IiwiYWRkU3R1ZGVudCIsInVwZGF0ZVN0dWRlbnQiLCJtYXAiLCJNYXAiLCJpbmRleCIsInNldCIsInRha2VBdHRlbmRhbmNlIiwiZ2V0QXR0ZW5kYW5jZUxpc3QiLCJhdHRlbmRhbmNlTGlzdCIsInNlbGVjdExpc3RXaXRoQXR0ZW5kYW5jZUlkIiwib3B0aW9uIiwibGlzdFdpdGhBdHRlbmRhbmNlSWQiLCJhdHRlbmRhbmNlcyIsInN0dWRlbnRBdHRlbmRhbmNlcyIsInNlcXVlbmNlIiwiYXR0ZW5kYW5jZUlkIiwiZmlsdGVyIiwiZ2V0U3R1ZGVudEF0dGVuZGFuY2VzIiwiZ2V0QXR0ZW5kYW5jZXNCeUF0dGVuZGFuY2VJZCIsInN0dWRlbnRBdHRlbmRhbmNlIiwiZ2V0QXR0ZW5kYW5jZXNCeVN0dWRlbnRJZCIsInN0dWRlbnRJZCIsImF0dGVuZGFuY2VNYXAiLCJBdHRlbmRhbmNlIiwicHVzaCIsIlN0dWRlbnRBdHRlbmRhbmNlIiwiYXBpVXJsIiwiX3N0dWRlbnRzIiwiX3NlcXVlbmNlIiwicmVzcG9uc2UiLCJtZXRob2QiLCJoZWFkZXJzIiwiQWNjZXB0Iiwib2siLCJzdGF0dXMiLCJyZXN1bHQiLCJqc29uIiwiSlNPTiIsInBhcnNlIiwic3RyaW5naWZ5IiwiYm9keSIsIlN0dWRlbnQiLCJ0aGVuIiwiZmluZCIsInN0dWRlbnRzIiwiX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiY2FjaGVkTW9kdWxlIiwidW5kZWZpbmVkIiwiX193ZWJwYWNrX21vZHVsZXNfXyIsImNhbGwiXSwic291cmNlUm9vdCI6IiJ9